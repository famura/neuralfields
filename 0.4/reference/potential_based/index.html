<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A type of potential-based recurrent neural networks implemented with PyTorch"><meta name=author content="Fabio Muratore"><link href=https://famura.github.io/neuralfields/0.4/reference/potential_based/ rel=canonical><link href=../neural_fields/ rel=prev><link href=../simple_neural_fields/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.28"><title>potential_based - neuralfields</title><link rel=stylesheet href=../../assets/stylesheets/main.6543a935.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#neuralfields.potential_based class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=neuralfields class="md-header__button md-logo" aria-label=neuralfields data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> neuralfields </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> potential_based </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=deep-orange data-md-color-accent=deep-orange aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/famura/neuralfields title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> famura/neuralfields </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Overview </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> Code Reference </a> </li> <li class=md-tabs__item> <a href=../../contributing/ class=md-tabs__link> Development </a> </li> <li class=md-tabs__item> <a href=../../license/ class=md-tabs__link> License </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=neuralfields class="md-nav__button md-logo" aria-label=neuralfields data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> neuralfields </label> <div class=md-nav__source> <a href=https://github.com/famura/neuralfields title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> famura/neuralfields </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <div class="md-nav__link md-nav__container"> <a href=../.. class="md-nav__link "> <span class=md-ellipsis> Overview </span> </a> <label class="md-nav__link " for=__nav_1 id=__nav_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Overview </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting_started/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../../exported/changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Code Reference </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Code Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../custom_layers/ class=md-nav__link> <span class=md-ellipsis> custom_layers </span> </a> </li> <li class=md-nav__item> <a href=../custom_types/ class=md-nav__link> <span class=md-ellipsis> custom_types </span> </a> </li> <li class=md-nav__item> <a href=../neural_fields/ class=md-nav__link> <span class=md-ellipsis> neural_fields </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> potential_based </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> potential_based </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#neuralfields.potential_based class=md-nav__link> <span class=md-ellipsis> potential_based </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased class=md-nav__link> <span class=md-ellipsis> PotentialBased </span> </a> <nav class=md-nav aria-label=PotentialBased> <ul class=md-nav__list> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.device class=md-nav__link> <span class=md-ellipsis> device </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.hidden_size class=md-nav__link> <span class=md-ellipsis> hidden_size </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.kappa class=md-nav__link> <span class=md-ellipsis> kappa </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.param_values class=md-nav__link> <span class=md-ellipsis> param_values </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.stimuli_external class=md-nav__link> <span class=md-ellipsis> stimuli_external </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.stimuli_internal class=md-nav__link> <span class=md-ellipsis> stimuli_internal </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.tau class=md-nav__link> <span class=md-ellipsis> tau </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.forward class=md-nav__link> <span class=md-ellipsis> forward </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.forward_one_step class=md-nav__link> <span class=md-ellipsis> forward_one_step </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.init_hidden class=md-nav__link> <span class=md-ellipsis> init_hidden </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.potentials_dot class=md-nav__link> <span class=md-ellipsis> potentials_dot </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../simple_neural_fields/ class=md-nav__link> <span class=md-ellipsis> simple_neural_fields </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Development </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Development </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../exported/coverage/report.html class=md-nav__link> <span class=md-ellipsis> Coverage </span> </a> </li> <li class=md-nav__item> <a href=../../exported/tests/report.html class=md-nav__link> <span class=md-ellipsis> Tests </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> License </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> License </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../license/ class=md-nav__link> <span class=md-ellipsis> This Project </span> </a> </li> <li class=md-nav__item> <a href=../../exported/third_party_licenses/ class=md-nav__link> <span class=md-ellipsis> Third-Party Libraries </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#neuralfields.potential_based class=md-nav__link> <span class=md-ellipsis> potential_based </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased class=md-nav__link> <span class=md-ellipsis> PotentialBased </span> </a> <nav class=md-nav aria-label=PotentialBased> <ul class=md-nav__list> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.device class=md-nav__link> <span class=md-ellipsis> device </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.hidden_size class=md-nav__link> <span class=md-ellipsis> hidden_size </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.kappa class=md-nav__link> <span class=md-ellipsis> kappa </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.param_values class=md-nav__link> <span class=md-ellipsis> param_values </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.stimuli_external class=md-nav__link> <span class=md-ellipsis> stimuli_external </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.stimuli_internal class=md-nav__link> <span class=md-ellipsis> stimuli_internal </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.tau class=md-nav__link> <span class=md-ellipsis> tau </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.forward class=md-nav__link> <span class=md-ellipsis> forward </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.forward_one_step class=md-nav__link> <span class=md-ellipsis> forward_one_step </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.init_hidden class=md-nav__link> <span class=md-ellipsis> init_hidden </span> </a> </li> <li class=md-nav__item> <a href=#neuralfields.potential_based.PotentialBased.potentials_dot class=md-nav__link> <span class=md-ellipsis> potentials_dot </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>potential_based</h1> <div class="doc doc-object doc-module"> <a id=neuralfields.potential_based></a> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=neuralfields.potential_based.PotentialBased class="doc doc-heading"> <code class="highlight language-python"><span class=n>PotentialBased</span><span class=p>(</span><span class=n>input_size</span><span class=p>,</span> <span class=n>hidden_size</span><span class=p>,</span> <span class=n>activation_nonlin</span><span class=p>,</span> <span class=n>tau_init</span><span class=p>,</span> <span class=n>tau_learnable</span><span class=p>,</span> <span class=n>kappa_init</span><span class=p>,</span> <span class=n>kappa_learnable</span><span class=p>,</span> <span class=n>potentials_init</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>output_size</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>input_embedding</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>output_embedding</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>device</span><span class=o>=</span><span class=s1>&#39;cpu&#39;</span><span class=p>)</span></code> <a href=#neuralfields.potential_based.PotentialBased class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-external" title="torch.nn.Module" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module">Module</a></code>, <code><a class="autorefs autorefs-external" title="abc.ABC" href="https://docs.python.org/3/library/abc.html#abc.ABC">ABC</a></code></p> <p>Base class for all potential-based recurrent neutral networks.</p> <div class=highlight><pre><span></span><code>hidden_size: Number of neurons with potential per hidden layer. For all use cases conceived at this point,
    we only use one recurrent layer. However, there is the possibility to extend the networks to multiple
    potential-based layers.
activation_nonlin: Nonlinearity used to compute the activations from the potential levels.
tau_init: Initial value for the shared time constant of the potentials.
tau_learnable: Whether the time constant is a learnable parameter or fixed.
kappa_init: Initial value for the cubic decay, pass 0 to disable the cubic decay.
kappa_learnable: Whether the cubic decay is a learnable parameter or fixed.
potentials_init: Initial for the potentials, i.e., the network&#39;s hidden state.
output_size: Number of output dimensions. By default, the number of outputs is equal to the number of
    hidden neurons.
input_embedding: Optional (custom) [Module][torch.nn.Module] to extract features from the inputs.
    This module must transform the inputs such that the dimensionality matches the number of
    neurons of the neural field, i.e., `hidden_size`. By default, a [linear layer][torch.nn.Linear]
    without biases is used.
output_embedding: Optional (custom) [Module][torch.nn.Module] to compute the outputs from the activations.
    This module must map the activations of shape (`hidden_size`,) to the outputs of shape (`output_size`,)
    By default, a [linear layer][torch.nn.Linear] without biases is used.
device: Device to move this module to (after initialization).
</code></pre></div> <details class=quote> <summary>Source code in <code>neuralfields/potential_based.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 21</span>
<span class=normal> 22</span>
<span class=normal> 23</span>
<span class=normal> 24</span>
<span class=normal> 25</span>
<span class=normal> 26</span>
<span class=normal> 27</span>
<span class=normal> 28</span>
<span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span>
    <span class=n>input_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
    <span class=n>hidden_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
    <span class=n>activation_nonlin</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>ActivationFunction</span><span class=p>,</span> <span class=n>Sequence</span><span class=p>[</span><span class=n>ActivationFunction</span><span class=p>]],</span>
    <span class=n>tau_init</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>int</span><span class=p>],</span>
    <span class=n>tau_learnable</span><span class=p>:</span> <span class=nb>bool</span><span class=p>,</span>
    <span class=n>kappa_init</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>int</span><span class=p>],</span>
    <span class=n>kappa_learnable</span><span class=p>:</span> <span class=nb>bool</span><span class=p>,</span>
    <span class=n>potentials_init</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=n>output_size</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=n>input_embedding</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=n>output_embedding</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=n>device</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>torch</span><span class=o>.</span><span class=n>device</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;cpu&quot;</span><span class=p>,</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Args:</span>
<span class=sd>        input_size: Number of input dimensions.</span>
<span class=sd>        hidden_size: Number of neurons with potential per hidden layer. For all use cases conceived at this point,</span>
<span class=sd>            we only use one recurrent layer. However, there is the possibility to extend the networks to multiple</span>
<span class=sd>            potential-based layers.</span>
<span class=sd>        activation_nonlin: Nonlinearity used to compute the activations from the potential levels.</span>
<span class=sd>        tau_init: Initial value for the shared time constant of the potentials.</span>
<span class=sd>        tau_learnable: Whether the time constant is a learnable parameter or fixed.</span>
<span class=sd>        kappa_init: Initial value for the cubic decay, pass 0 to disable the cubic decay.</span>
<span class=sd>        kappa_learnable: Whether the cubic decay is a learnable parameter or fixed.</span>
<span class=sd>        potentials_init: Initial for the potentials, i.e., the network&#39;s hidden state.</span>
<span class=sd>        output_size: Number of output dimensions. By default, the number of outputs is equal to the number of</span>
<span class=sd>            hidden neurons.</span>
<span class=sd>        input_embedding: Optional (custom) [Module][torch.nn.Module] to extract features from the inputs.</span>
<span class=sd>            This module must transform the inputs such that the dimensionality matches the number of</span>
<span class=sd>            neurons of the neural field, i.e., `hidden_size`. By default, a [linear layer][torch.nn.Linear]</span>
<span class=sd>            without biases is used.</span>
<span class=sd>        output_embedding: Optional (custom) [Module][torch.nn.Module] to compute the outputs from the activations.</span>
<span class=sd>            This module must map the activations of shape (`hidden_size`,) to the outputs of shape (`output_size`,)</span>
<span class=sd>            By default, a [linear layer][torch.nn.Linear] without biases is used.</span>
<span class=sd>        device: Device to move this module to (after initialization).</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># Call torch.nn.Module&#39;s constructor.</span>
    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>

    <span class=c1># For all use cases conceived at this point, we only use one recurrent layer. However, this variable still</span>
    <span class=c1># exists in case somebody in the future wants to try multiple potential-based layers. It will require more</span>
    <span class=c1># changes than increasing this number.</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>num_recurrent_layers</span> <span class=o>=</span> <span class=mi>1</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>input_size</span> <span class=o>=</span> <span class=n>input_size</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_hidden_size</span> <span class=o>=</span> <span class=n>hidden_size</span> <span class=o>//</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_recurrent_layers</span>  <span class=c1># hidden size per layer</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>output_size</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_hidden_size</span> <span class=k>if</span> <span class=n>output_size</span> <span class=ow>is</span> <span class=kc>None</span> <span class=k>else</span> <span class=n>output_size</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_stimuli_external</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>hidden_size</span><span class=p>,</span> <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>)</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_stimuli_internal</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>hidden_size</span><span class=p>,</span> <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>)</span>

    <span class=c1># Create the common layers.</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>input_embedding</span> <span class=o>=</span> <span class=n>input_embedding</span> <span class=ow>or</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>input_size</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_hidden_size</span><span class=p>,</span> <span class=n>bias</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>output_embedding</span> <span class=o>=</span> <span class=n>output_embedding</span> <span class=ow>or</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_hidden_size</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>output_size</span><span class=p>,</span> <span class=n>bias</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

    <span class=c1># Initialize the values of the potentials.</span>
    <span class=k>if</span> <span class=n>potentials_init</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_potentials_init</span> <span class=o>=</span> <span class=n>potentials_init</span><span class=o>.</span><span class=n>detach</span><span class=p>()</span><span class=o>.</span><span class=n>clone</span><span class=p>()</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>activation_nonlin</span> <span class=ow>is</span> <span class=n>torch</span><span class=o>.</span><span class=n>sigmoid</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_potentials_init</span> <span class=o>=</span> <span class=o>-</span><span class=mi>7</span> <span class=o>*</span> <span class=n>torch</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>hidden_size</span><span class=p>,</span> <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_potentials_init</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>hidden_size</span><span class=p>,</span> <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>)</span>

    <span class=c1># Initialize the potentials&#39; resting level, i.e., the asymptotic level without stimuli.</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>resting_level</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Parameter</span><span class=p>(</span><span class=n>torch</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>hidden_size</span><span class=p>,</span> <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>))</span>

    <span class=c1># Initialize the potential dynamics&#39; time constant.</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>tau_learnable</span> <span class=o>=</span> <span class=n>tau_learnable</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_log_tau_init</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>log</span><span class=p>(</span>
        <span class=n>torch</span><span class=o>.</span><span class=n>as_tensor</span><span class=p>(</span><span class=n>tau_init</span><span class=p>,</span> <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>torch</span><span class=o>.</span><span class=n>get_default_dtype</span><span class=p>())</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>)</span>
    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>tau_learnable</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_log_tau</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Parameter</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_log_tau_init</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_log_tau</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_log_tau_init</span>

    <span class=c1># Initialize the potential dynamics&#39; cubic decay.</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>kappa_learnable</span> <span class=o>=</span> <span class=n>kappa_learnable</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_log_kappa_init</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>log</span><span class=p>(</span>
        <span class=n>torch</span><span class=o>.</span><span class=n>as_tensor</span><span class=p>(</span><span class=n>kappa_init</span><span class=p>,</span> <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>torch</span><span class=o>.</span><span class=n>get_default_dtype</span><span class=p>())</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>)</span>
    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>kappa_learnable</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_log_kappa</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Parameter</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_log_kappa_init</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_log_kappa</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_log_kappa_init</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 id=neuralfields.potential_based.PotentialBased.device class="doc doc-heading"> <code class="highlight language-python"><span class=n>device</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>device</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#neuralfields.potential_based.PotentialBased.device class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Get the device this model is located on. This assumes that all parts are located on the same device.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=neuralfields.potential_based.PotentialBased.hidden_size class="doc doc-heading"> <code class="highlight language-python"><span class=n>hidden_size</span><span class=p>:</span> <span class=nb>int</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#neuralfields.potential_based.PotentialBased.hidden_size class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Get the number of neurons in the neural field layer, i.e., the ones with the in-/exhibition dynamics.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=neuralfields.potential_based.PotentialBased.kappa class="doc doc-heading"> <code class="highlight language-python"><span class=n>kappa</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>,</span> <span class=n>nn</span><span class=o>.</span><span class=n>Parameter</span><span class=p>]</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#neuralfields.potential_based.PotentialBased.kappa class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Get the cubic decay parameter <span class=arithmatex>\(\kappa\)</span>.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=neuralfields.potential_based.PotentialBased.param_values class="doc doc-heading"> <code class="highlight language-python"><span class=n>param_values</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> <a href=#neuralfields.potential_based.PotentialBased.param_values class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Get the module's parameters as a 1-dimensional array. The values are copied, thus modifying the return value does not propagate back to the module parameters.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=neuralfields.potential_based.PotentialBased.stimuli_external class="doc doc-heading"> <code class="highlight language-python"><span class=n>stimuli_external</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#neuralfields.potential_based.PotentialBased.stimuli_external class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Get the neurons' external stimuli, resulting from the current inputs. This property is useful for recording during a simulation / rollout.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=neuralfields.potential_based.PotentialBased.stimuli_internal class="doc doc-heading"> <code class="highlight language-python"><span class=n>stimuli_internal</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#neuralfields.potential_based.PotentialBased.stimuli_internal class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Get the neurons' internal stimuli, resulting from the previous activations of the neurons. This property is useful for recording during a simulation / rollout.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=neuralfields.potential_based.PotentialBased.tau class="doc doc-heading"> <code class="highlight language-python"><span class=n>tau</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>,</span> <span class=n>nn</span><span class=o>.</span><span class=n>Parameter</span><span class=p>]</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#neuralfields.potential_based.PotentialBased.tau class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Get the timescale parameter, called <span class=arithmatex>\(\tau\)</span> in the original paper [Amari_77].</p> </div> </div> <div class="doc doc-object doc-function"> <h3 id=neuralfields.potential_based.PotentialBased.forward class="doc doc-heading"> <code class="highlight language-python"><span class=n>forward</span><span class=p>(</span><span class=n>inputs</span><span class=p>,</span> <span class=n>hidden</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#neuralfields.potential_based.PotentialBased.forward class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Compute the external and internal stimuli, advance the potential dynamics for one time step, and return the model's output for several time steps in a row.</p> <p>This method essentially calls <a class="autorefs autorefs-internal" href="#neuralfields.potential_based.PotentialBased.forward_one_step">forward_one_step</a> several times in a row.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>inputs</code></td> <td> <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a></code> </td> <td> <div class=doc-md-description> <p>Inputs of shape <code>(batch_size, num_steps, dim_input)</code> to evaluate the network on.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>hidden</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a>]</code> </td> <td> <div class=doc-md-description> <p>Initial values of the hidden states, i.e., the potentials. By default, the network initialized the hidden state to be all zeros. However, via this argument one can set a specific initial value for the potentials. Depending on the shape of <code>inputs</code>, <code>hidden</code> is of shape <code>(hidden_size,)</code> if the input was not batched, else of shape <code>(batch_size, hidden_size)</code>.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a></code> </td> <td> <div class=doc-md-description> <p>The outputs, i.e., the (linearly combined) activations, and all intermediate potential values, both of</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a></code> </td> <td> <div class=doc-md-description> <p>shape <code>(batch_size, num_steps, dim_output)</code>.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>neuralfields/potential_based.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>inputs</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>,</span> <span class=n>hidden</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>,</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Compute the external and internal stimuli, advance the potential dynamics for one time step, and return</span>
<span class=sd>    the model&#39;s output for several time steps in a row.</span>

<span class=sd>    This method essentially calls [forward_one_step][neuralfields.PotentialBased.forward_one_step] several times</span>
<span class=sd>    in a row.</span>

<span class=sd>    Args:</span>
<span class=sd>        inputs: Inputs of shape `(batch_size, num_steps, dim_input)` to evaluate the network on.</span>
<span class=sd>        hidden: Initial values of the hidden states, i.e., the potentials. By default, the network initialized</span>
<span class=sd>            the hidden state to be all zeros. However, via this argument one can set a specific initial value</span>
<span class=sd>            for the potentials. Depending on the shape of `inputs`, `hidden` is of shape `(hidden_size,)` if</span>
<span class=sd>            the input was not batched, else of shape `(batch_size, hidden_size)`.</span>

<span class=sd>    Returns:</span>
<span class=sd>        The outputs, i.e., the (linearly combined) activations, and all intermediate potential values, both of</span>
<span class=sd>        shape `(batch_size, num_steps, dim_output)`.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># Bring the sequence of inputs into the shape (batch_size, num_steps, dim_input).</span>
    <span class=n>batch_size</span> <span class=o>=</span> <span class=n>PotentialBased</span><span class=o>.</span><span class=n>_infer_batch_size</span><span class=p>(</span><span class=n>inputs</span><span class=p>)</span>
    <span class=n>inputs</span> <span class=o>=</span> <span class=n>inputs</span><span class=o>.</span><span class=n>view</span><span class=p>(</span><span class=n>batch_size</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>input_size</span><span class=p>)</span>  <span class=c1># moved to the desired device by forward_one_step() later</span>

    <span class=c1># If given use the hidden tensor, i.e., the potentials of the last step, else initialize them.</span>
    <span class=n>hidden</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>init_hidden</span><span class=p>(</span><span class=n>batch_size</span><span class=p>,</span> <span class=n>hidden</span><span class=p>)</span>  <span class=c1># moved to the desired device by forward_one_step() later</span>

    <span class=c1># Iterate over the time dimension. Do this in parallel for all batched which are still along the 1st dimension.</span>
    <span class=n>inputs</span> <span class=o>=</span> <span class=n>inputs</span><span class=o>.</span><span class=n>permute</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>  <span class=c1># move time to first dimension for easy iterating</span>
    <span class=n>outputs_all</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>hidden_all</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>inp</span> <span class=ow>in</span> <span class=n>inputs</span><span class=p>:</span>
        <span class=n>outputs</span><span class=p>,</span> <span class=n>hidden_next</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>forward_one_step</span><span class=p>(</span><span class=n>inp</span><span class=p>,</span> <span class=n>hidden</span><span class=p>)</span>
        <span class=n>hidden</span> <span class=o>=</span> <span class=n>hidden_next</span><span class=o>.</span><span class=n>clone</span><span class=p>()</span>
        <span class=n>outputs_all</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>outputs</span><span class=p>)</span>
        <span class=n>hidden_all</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>hidden_next</span><span class=p>)</span>

    <span class=c1># Return the outputs and hidden states, both stacked along the time dimension.</span>
    <span class=k>return</span> <span class=n>torch</span><span class=o>.</span><span class=n>stack</span><span class=p>(</span><span class=n>outputs_all</span><span class=p>,</span> <span class=n>dim</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span> <span class=n>torch</span><span class=o>.</span><span class=n>stack</span><span class=p>(</span><span class=n>hidden_all</span><span class=p>,</span> <span class=n>dim</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=neuralfields.potential_based.PotentialBased.forward_one_step class="doc doc-heading"> <code class="highlight language-python"><span class=n>forward_one_step</span><span class=p>(</span><span class=n>inputs</span><span class=p>,</span> <span class=n>hidden</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> <a href=#neuralfields.potential_based.PotentialBased.forward_one_step class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Compute the external and internal stimuli, advance the potential dynamics for one time step, and return the model's output.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>inputs</code></td> <td> <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a></code> </td> <td> <div class=doc-md-description> <p>Inputs of the current time step, of shape <code>(input_size,)</code>, or <code>(batch_size, input_size)</code>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>hidden</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a>]</code> </td> <td> <div class=doc-md-description> <p>Hidden state which are for the model in this package the potentials, of shape <code>(hidden_size,)</code>, or <code>(batch_size, input_size)</code>. Pass <code>None</code> to leave the initialization to the network which uses <a class="autorefs autorefs-internal" href="#neuralfields.potential_based.PotentialBased.init_hidden">init_hidden</a> is called.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a></code> </td> <td> <div class=doc-md-description> <p>The outputs, i.e., the (linearly combined) activations, and the most recent potential values, both of shape</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a></code> </td> <td> <div class=doc-md-description> <p><code>(batch_size, input_size)</code>.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>neuralfields/potential_based.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@abstractmethod</span>
<span class=k>def</span> <span class=nf>forward_one_step</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>inputs</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>,</span> <span class=n>hidden</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>,</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Compute the external and internal stimuli, advance the potential dynamics for one time step, and return</span>
<span class=sd>    the model&#39;s output.</span>

<span class=sd>    Args:</span>
<span class=sd>        inputs: Inputs of the current time step, of shape `(input_size,)`, or `(batch_size, input_size)`.</span>
<span class=sd>        hidden: Hidden state which are for the model in this package the potentials, of shape `(hidden_size,)`, or</span>
<span class=sd>            `(batch_size, input_size)`. Pass `None` to leave the initialization to the network which uses</span>
<span class=sd>            [init_hidden][neuralfields.PotentialBased.init_hidden] is called.</span>

<span class=sd>    Returns:</span>
<span class=sd>        The outputs, i.e., the (linearly combined) activations, and the most recent potential values, both of shape</span>
<span class=sd>        `(batch_size, input_size)`.</span>
<span class=sd>    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=neuralfields.potential_based.PotentialBased.init_hidden class="doc doc-heading"> <code class="highlight language-python"><span class=n>init_hidden</span><span class=p>(</span><span class=n>batch_size</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>potentials_init</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#neuralfields.potential_based.PotentialBased.init_hidden class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Provide initial values for the hidden parameters. This usually is a zero tensor.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>batch_size</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code> </td> <td> <div class=doc-md-description> <p>Number of batches, i.e., states to track in parallel.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>potentials_init</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a>]</code> </td> <td> <div class=doc-md-description> <p>Initial values for the potentials to override the networks default values with.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a>, <span title="torch.nn.Parameter">Parameter</span>]</code> </td> <td> <div class=doc-md-description> <p>Tensor of shape <code>(hidden_size,)</code> if <code>hidden</code> was not batched, else of shape <code>(batch_size, hidden_size)</code>.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>neuralfields/potential_based.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>init_hidden</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span> <span class=n>potentials_init</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>,</span> <span class=n>torch</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>Parameter</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Provide initial values for the hidden parameters. This usually is a zero tensor.</span>

<span class=sd>    Args:</span>
<span class=sd>        batch_size: Number of batches, i.e., states to track in parallel.</span>
<span class=sd>        potentials_init: Initial values for the potentials to override the networks default values with.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Tensor of shape `(hidden_size,)` if `hidden` was not batched, else of shape `(batch_size, hidden_size)`.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>potentials_init</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>batch_size</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_potentials_init</span><span class=o>.</span><span class=n>view</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_potentials_init</span><span class=o>.</span><span class=n>repeat</span><span class=p>(</span><span class=n>batch_size</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>device</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>device</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>potentials_init</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>device</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>device</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=neuralfields.potential_based.PotentialBased.potentials_dot class="doc doc-heading"> <code class="highlight language-python"><span class=n>potentials_dot</span><span class=p>(</span><span class=n>potentials</span><span class=p>,</span> <span class=n>stimuli</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> <a href=#neuralfields.potential_based.PotentialBased.potentials_dot class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Compute the derivative of the neurons' potentials w.r.t. time.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>potentials</code></td> <td> <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a></code> </td> <td> <div class=doc-md-description> <p>Potential values at the current point in time, of shape <code>(hidden_size,)</code>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>stimuli</code></td> <td> <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a></code> </td> <td> <div class=doc-md-description> <p>Sum of external and internal stimuli at the current point in time, of shape <code>(hidden_size,)</code>.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a></code> </td> <td> <div class=doc-md-description> <p>Time derivative of the potentials $ rac{dp}{dt}$, of shape <code>(hidden_size,)</code>.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>neuralfields/potential_based.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>164</span>
<span class=normal>165</span>
<span class=normal>166</span>
<span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@abstractmethod</span>
<span class=k>def</span> <span class=nf>potentials_dot</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>potentials</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>,</span> <span class=n>stimuli</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Compute the derivative of the neurons&#39; potentials w.r.t. time.</span>

<span class=sd>    Args:</span>
<span class=sd>        potentials: Potential values at the current point in time, of shape `(hidden_size,)`.</span>
<span class=sd>        stimuli: Sum of external and internal stimuli at the current point in time, of shape `(hidden_size,)`.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Time derivative of the potentials $\frac{dp}{dt}$, of shape `(hidden_size,)`.</span>
<span class=sd>    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">July 8, 2024</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["header.autohide", "navigation.indexes", "navigation.instant", "navigation.tabs", "navigation.top", "search.highlight", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.fe8b6f2b.min.js></script> <script src=https://unpkg.com/tablesort/dist/tablesort.min.js></script> <script src=../../js/tablesort.js></script> <script src=../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>